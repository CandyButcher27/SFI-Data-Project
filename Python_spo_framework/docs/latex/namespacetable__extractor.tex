\doxysection{table\+\_\+extractor Namespace Reference}
\hypertarget{namespacetable__extractor}{}\label{namespacetable__extractor}\index{table\_extractor@{table\_extractor}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacetable__extractor_a0109e45b883a3d7b849c4965a7326a1c}{find\+\_\+framework\+\_\+and\+\_\+spo\+\_\+pdfs}} (folder\+\_\+path)
\item 
\mbox{\hyperlink{namespacetable__extractor_ae194f3fe9d1ca05231b57a81948e8916}{get\+\_\+pages\+\_\+with\+\_\+tables\+\_\+pdfplumber}} (pdf\+\_\+path)
\item 
\mbox{\hyperlink{namespacetable__extractor_a6427afc7820a4277bc906b9cef6bdbce}{assemble\+\_\+pages\+\_\+with\+\_\+pypdf}} (src\+\_\+pdf\+\_\+path, page\+\_\+indices, writer=None)
\item 
\mbox{\hyperlink{namespacetable__extractor_ac3381030fc27c6f7a3bb26e62e0c7104}{create\+\_\+label\+\_\+page\+\_\+bytes}} (text)
\item 
\mbox{\hyperlink{namespacetable__extractor_a7c361be5614024de7da6cdd190e80f32}{write\+\_\+temp\+\_\+merged\+\_\+pdf}} (framework\+\_\+pdf, spo\+\_\+pdf, tmp\+\_\+suffix="{}.pdf"{})
\item 
\mbox{\hyperlink{namespacetable__extractor_a526e88738d6f6e9598f5abaffba44f3c}{call\+\_\+whisperer\+\_\+and\+\_\+get\+\_\+text}} (merged\+\_\+pdf\+\_\+path)
\item 
\mbox{\hyperlink{namespacetable__extractor_ae774b18d3100007f4d60e98544722f26}{process\+\_\+subfolders\+\_\+in\+\_\+memory}} (root\+\_\+folder)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacetable__extractor_a82593d5a3e660fec793b47a88741a8a6}{ROOT\+\_\+\+FOLDER}} = MAIN\+\_\+\+FOLDER
\item 
\mbox{\hyperlink{namespacetable__extractor_a27cc42e3d67495d55ae7ca51ba0d6c47}{WHISPERER\+\_\+\+BASE}} = WHISPERER\+\_\+\+BASE
\item 
\mbox{\hyperlink{namespacetable__extractor_abc0639c65f37d514d8ede6b70920f9d4}{WHISPERER\+\_\+\+API\+\_\+\+KEY}} = os.\+getenv("{}LLMWHISPERER\+\_\+\+API\+\_\+\+KEY"{})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}table_extractor.py

Extracts table data from SPO and framework PDFs per company:
- Detects framework and SPO PDFs in each company folder
- Identifies pages containing tables using pdfplumber
- Merges relevant pages into a temporary PDF
- Sends the merged PDF to LLM Whisperer for extraction
- Returns the extracted text per company
\end{DoxyVerb}
 

\label{doc-func-members}
\Hypertarget{namespacetable__extractor_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{namespacetable__extractor_a6427afc7820a4277bc906b9cef6bdbce}\index{table\_extractor@{table\_extractor}!assemble\_pages\_with\_pypdf@{assemble\_pages\_with\_pypdf}}
\index{assemble\_pages\_with\_pypdf@{assemble\_pages\_with\_pypdf}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{assemble\_pages\_with\_pypdf()}{assemble\_pages\_with\_pypdf()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_a6427afc7820a4277bc906b9cef6bdbce} 
table\+\_\+extractor.\+assemble\+\_\+pages\+\_\+with\+\_\+pypdf (\begin{DoxyParamCaption}\item[{}]{src\+\_\+pdf\+\_\+path}{, }\item[{}]{page\+\_\+indices}{, }\item[{}]{writer}{ = {\ttfamily None}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Add selected pages from a source PDF to a PdfWriter object.

Args:
    src_pdf_path (str): Path to the source PDF.
    page_indices (List[int]): List of 0-based page indices to add.
    writer (PdfWriter, optional): Existing PdfWriter object. Creates new if None.

Returns:
    PdfWriter: Updated PdfWriter object containing selected pages.
\end{DoxyVerb}
 \Hypertarget{namespacetable__extractor_a526e88738d6f6e9598f5abaffba44f3c}\index{table\_extractor@{table\_extractor}!call\_whisperer\_and\_get\_text@{call\_whisperer\_and\_get\_text}}
\index{call\_whisperer\_and\_get\_text@{call\_whisperer\_and\_get\_text}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{call\_whisperer\_and\_get\_text()}{call\_whisperer\_and\_get\_text()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_a526e88738d6f6e9598f5abaffba44f3c} 
table\+\_\+extractor.\+call\+\_\+whisperer\+\_\+and\+\_\+get\+\_\+text (\begin{DoxyParamCaption}\item[{}]{merged\+\_\+pdf\+\_\+path}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Send a PDF to LLM Whisperer and return the extracted text.

Args:
    merged_pdf_path (str): Path to the merged PDF.

Returns:
    str: Extracted text from the PDF.

Raises:
    RuntimeError: If Whisperer does not return a valid whisper_hash.
\end{DoxyVerb}
 \Hypertarget{namespacetable__extractor_ac3381030fc27c6f7a3bb26e62e0c7104}\index{table\_extractor@{table\_extractor}!create\_label\_page\_bytes@{create\_label\_page\_bytes}}
\index{create\_label\_page\_bytes@{create\_label\_page\_bytes}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{create\_label\_page\_bytes()}{create\_label\_page\_bytes()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_ac3381030fc27c6f7a3bb26e62e0c7104} 
table\+\_\+extractor.\+create\+\_\+label\+\_\+page\+\_\+bytes (\begin{DoxyParamCaption}\item[{}]{text}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a single-page PDF as bytes containing a centered label text.

Args:
    text (str): Label text to place on the PDF page.

Returns:
    bytes: PDF file content in bytes.
\end{DoxyVerb}
 \Hypertarget{namespacetable__extractor_a0109e45b883a3d7b849c4965a7326a1c}\index{table\_extractor@{table\_extractor}!find\_framework\_and\_spo\_pdfs@{find\_framework\_and\_spo\_pdfs}}
\index{find\_framework\_and\_spo\_pdfs@{find\_framework\_and\_spo\_pdfs}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{find\_framework\_and\_spo\_pdfs()}{find\_framework\_and\_spo\_pdfs()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_a0109e45b883a3d7b849c4965a7326a1c} 
table\+\_\+extractor.\+find\+\_\+framework\+\_\+and\+\_\+spo\+\_\+pdfs (\begin{DoxyParamCaption}\item[{}]{folder\+\_\+path}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the framework and SPO PDF paths from a given folder.

Args:
    folder_path (str): Path to the company's folder.

Returns:
    Tuple[str | None, str | None]: (framework_pdf_path, spo_pdf_path). None if not found.
\end{DoxyVerb}
 \Hypertarget{namespacetable__extractor_ae194f3fe9d1ca05231b57a81948e8916}\index{table\_extractor@{table\_extractor}!get\_pages\_with\_tables\_pdfplumber@{get\_pages\_with\_tables\_pdfplumber}}
\index{get\_pages\_with\_tables\_pdfplumber@{get\_pages\_with\_tables\_pdfplumber}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{get\_pages\_with\_tables\_pdfplumber()}{get\_pages\_with\_tables\_pdfplumber()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_ae194f3fe9d1ca05231b57a81948e8916} 
table\+\_\+extractor.\+get\+\_\+pages\+\_\+with\+\_\+tables\+\_\+pdfplumber (\begin{DoxyParamCaption}\item[{}]{pdf\+\_\+path}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the 0-based page indices of a PDF that contain tables.

Args:
    pdf_path (str): Path to the PDF file.

Returns:
    List[int]: List of page indices containing tables.
\end{DoxyVerb}
 \Hypertarget{namespacetable__extractor_ae774b18d3100007f4d60e98544722f26}\index{table\_extractor@{table\_extractor}!process\_subfolders\_in\_memory@{process\_subfolders\_in\_memory}}
\index{process\_subfolders\_in\_memory@{process\_subfolders\_in\_memory}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{process\_subfolders\_in\_memory()}{process\_subfolders\_in\_memory()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_ae774b18d3100007f4d60e98544722f26} 
table\+\_\+extractor.\+process\+\_\+subfolders\+\_\+in\+\_\+memory (\begin{DoxyParamCaption}\item[{}]{root\+\_\+folder}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Process all company subfolders in memory:
- Find framework and SPO PDFs
- Extract table pages
- Merge pages into temporary PDF
- Send to LLM Whisperer
- Return extracted text per company

Args:
    root_folder (str): Path to the root folder containing company subfolders.

Returns:
    Dict[str, str]: Mapping of company name to extracted text.
\end{DoxyVerb}
 \Hypertarget{namespacetable__extractor_a7c361be5614024de7da6cdd190e80f32}\index{table\_extractor@{table\_extractor}!write\_temp\_merged\_pdf@{write\_temp\_merged\_pdf}}
\index{write\_temp\_merged\_pdf@{write\_temp\_merged\_pdf}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{write\_temp\_merged\_pdf()}{write\_temp\_merged\_pdf()}}
{\footnotesize\ttfamily \label{namespacetable__extractor_a7c361be5614024de7da6cdd190e80f32} 
table\+\_\+extractor.\+write\+\_\+temp\+\_\+merged\+\_\+pdf (\begin{DoxyParamCaption}\item[{}]{framework\+\_\+pdf}{, }\item[{}]{spo\+\_\+pdf}{, }\item[{}]{tmp\+\_\+suffix}{ = {\ttfamily "{}.pdf"{}}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a temporary merged PDF containing only pages with tables from framework and SPO PDFs.

Args:
    framework_pdf (str | None): Path to the framework PDF.
    spo_pdf (str | None): Path to the SPO PDF.
    tmp_suffix (str): Suffix for the temporary file (default ".pdf").

Returns:
    str | None: Path to the temporary merged PDF, or None if no pages were added.
\end{DoxyVerb}
 

\label{doc-var-members}
\Hypertarget{namespacetable__extractor_doc-var-members}
\doxysubsection{Variable Documentation}
\Hypertarget{namespacetable__extractor_a82593d5a3e660fec793b47a88741a8a6}\index{table\_extractor@{table\_extractor}!ROOT\_FOLDER@{ROOT\_FOLDER}}
\index{ROOT\_FOLDER@{ROOT\_FOLDER}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{ROOT\_FOLDER}{ROOT\_FOLDER}}
{\footnotesize\ttfamily \label{namespacetable__extractor_a82593d5a3e660fec793b47a88741a8a6} 
table\+\_\+extractor.\+ROOT\+\_\+\+FOLDER = MAIN\+\_\+\+FOLDER}

\Hypertarget{namespacetable__extractor_abc0639c65f37d514d8ede6b70920f9d4}\index{table\_extractor@{table\_extractor}!WHISPERER\_API\_KEY@{WHISPERER\_API\_KEY}}
\index{WHISPERER\_API\_KEY@{WHISPERER\_API\_KEY}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{WHISPERER\_API\_KEY}{WHISPERER\_API\_KEY}}
{\footnotesize\ttfamily \label{namespacetable__extractor_abc0639c65f37d514d8ede6b70920f9d4} 
table\+\_\+extractor.\+WHISPERER\+\_\+\+API\+\_\+\+KEY = os.\+getenv("{}LLMWHISPERER\+\_\+\+API\+\_\+\+KEY"{})}

\Hypertarget{namespacetable__extractor_a27cc42e3d67495d55ae7ca51ba0d6c47}\index{table\_extractor@{table\_extractor}!WHISPERER\_BASE@{WHISPERER\_BASE}}
\index{WHISPERER\_BASE@{WHISPERER\_BASE}!table\_extractor@{table\_extractor}}
\doxysubsubsection{\texorpdfstring{WHISPERER\_BASE}{WHISPERER\_BASE}}
{\footnotesize\ttfamily \label{namespacetable__extractor_a27cc42e3d67495d55ae7ca51ba0d6c47} 
table\+\_\+extractor.\+WHISPERER\+\_\+\+BASE = WHISPERER\+\_\+\+BASE}

